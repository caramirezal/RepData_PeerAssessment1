activityByWeek <- lapply(activityByWeek,function(x) tapply(x$steps,x$interval, mean))
par(mfrow=c(1,2))
par(mar=c(5,5,5,5))
with(activityByWeek, plot(intervals,weekday,
type = "l",
col="black",
main = "WeekDay",
xlab = "Time intervals",
ylab = "Average steps"),
ylim = c(0,260))
for (i in 1:length(wDays)) {
if ( wDays[i] %in% c("sábado","Domingo")) {
wDays[i] <- "weekend"
} else {
wDays[i] <- "weekday"
}
}
activityByWeek <- split(activity.inputed,activity.inputed$weekDays)
activityByWeek <- lapply(activityByWeek,function(x) tapply(x$steps,x$interval, mean))
par(mfrow=c(1,2))
par(mar=c(5,5,5,5))
plot(intervals,activity.inputed$weekday,
type = "l",
col="black",
main = "WeekDay",
xlab = "Time intervals",
ylab = "Average steps"),
for (i in 1:length(wDays)) {
if ( wDays[i] %in% c("sábado","Domingo")) {
wDays[i] <- "weekend"
} else {
wDays[i] <- "weekday"
}
}
activityByWeek <- split(activity.inputed,activity.inputed$weekDays)
activityByWeek <- lapply(activityByWeek,function(x) tapply(x$steps,x$interval, mean))
names(activityByWeek)
#par(mfrow=c(1,2))
#par(mar=c(5,5,5,5))
#plot(intervals,activity.inputed$weekday,
#                          type = "l",
#                          col="black",
#                          main = "WeekDay",
#                          xlab = "Time intervals",
#                          ylab = "Average steps"),
#                          ylim = c(0,260))
#par(mar=c(5,5,5,5))
#plot(intervals,weekend,
#                          type = "l",
#                          col="black",
#                          main = "Weekend",
#                          xlab = "",
#                          ylab = "",
#                          ylim = c(0,260))
activityByWeek <- activity.inputed
for (i in 1:length(wDays)) {
if ( wDays[i] %in% c("sábado","Domingo")) {
wDays[i] <- "weekend"
} else {
wDays[i] <- "weekday"
}
}
activityByWeek <- split(activity.inputed,activity.inputed$weekDays)
activityByWeek <- lapply(activityByWeek,function(x) tapply(x$steps,x$interval, mean))
names(activityByWeek)
#par(mfrow=c(1,2))
#par(mar=c(5,5,5,5))
#plot(intervals,activity.inputed$weekday,
#                          type = "l",
#                          col="black",
#                          main = "WeekDay",
#                          xlab = "Time intervals",
#                          ylab = "Average steps"),
#                          ylim = c(0,260))
#par(mar=c(5,5,5,5))
#plot(intervals,weekend,
#                          type = "l",
#                          col="black",
#                          main = "Weekend",
#                          xlab = "",
#                          ylab = "",
#                          ylim = c(0,260))
names(activityByWeek)
activityByWeek <- activity.inputed
for (i in 1:length(wDays)) {
if ( wDays[i] %in% c("sábado","Domingo")) {
wDays[i] <- "weekend"
} else {
wDays[i] <- "weekday"
}
}
activityByWeek <- split(activity.inputed,activity.inputed$weekDays)
#activityByWeek <- lapply(activityByWeek,function(x) tapply(x$steps,x$interval, mean))
names(activityByWeek)
#par(mfrow=c(1,2))
#par(mar=c(5,5,5,5))
#plot(intervals,activity.inputed$weekday,
#                          type = "l",
#                          col="black",
#                          main = "WeekDay",
#                          xlab = "Time intervals",
#                          ylab = "Average steps"),
#                          ylim = c(0,260))
#par(mar=c(5,5,5,5))
#plot(intervals,weekend,
#                          type = "l",
#                          col="black",
#                          main = "Weekend",
#                          xlab = "",
#                          ylab = "",
#                          ylim = c(0,260))
activityByWeek <- activity.inputed
for (i in 1:length(wDays)) {
if ( wDays[i] %in% c("sábado","Domingo")) {
wDays[i] <- "weekend"
} else {
wDays[i] <- "weekday"
}
}
activityByWeek <- split(activity.inputed,activity.inputed$weekDays)
#activityByWeek <- lapply(activityByWeek,function(x) tapply(x$steps,x$interval, mean))
names(activityByWeek)
#par(mfrow=c(1,2))
#par(mar=c(5,5,5,5))
#plot(intervals,activity.inputed$weekday,
#                          type = "l",
#                          col="black",
#                          main = "WeekDay",
#                          xlab = "Time intervals",
#                          ylab = "Average steps"),
#                          ylim = c(0,260))
#par(mar=c(5,5,5,5))
#plot(intervals,weekend,
#                          type = "l",
#                          col="black",
#                          main = "Weekend",
#                          xlab = "",
#                          ylab = "",
#                          ylim = c(0,260))
activityByWeek <- activity.inputed
for (i in 1:length(wDays)) {
if ( wDays[i] %in% c("sábado","Domingo")) {
wDays[i] <- "weekend"
} else {
wDays[i] <- "weekday"
}
}
activity.inputed$weekDays <- wDays
activityByWeek <- split(activity.inputed,activity.inputed$weekDays)
#activityByWeek <- lapply(activityByWeek,function(x) tapply(x$steps,x$interval, mean))
names(activityByWeek)
#par(mfrow=c(1,2))
#par(mar=c(5,5,5,5))
#plot(intervals,activity.inputed$weekday,
#                          type = "l",
#                          col="black",
#                          main = "WeekDay",
#                          xlab = "Time intervals",
#                          ylab = "Average steps"),
#                          ylim = c(0,260))
#par(mar=c(5,5,5,5))
#plot(intervals,weekend,
#                          type = "l",
#                          col="black",
#                          main = "Weekend",
#                          xlab = "",
#                          ylab = "",
#                          ylim = c(0,260))
activityByWeek <- activity.inputed
for (i in 1:length(wDays)) {
if ( wDays[i] %in% c("sábado","Domingo")) {
wDays[i] <- "weekend"
} else {
wDays[i] <- "weekday"
}
}
activity.inputed$weekDays <- wDays
activityByWeek <- split(activity.inputed,activity.inputed$weekDays)
activityByWeek <- lapply(activityByWeek,function(x) tapply(x$steps,x$interval, mean))
names(activityByWeek)
#par(mfrow=c(1,2))
#par(mar=c(5,5,5,5))
#plot(intervals,activity.inputed$weekday,
#                          type = "l",
#                          col="black",
#                          main = "WeekDay",
#                          xlab = "Time intervals",
#                          ylab = "Average steps"),
#                          ylim = c(0,260))
#par(mar=c(5,5,5,5))
#plot(intervals,weekend,
#                          type = "l",
#                          col="black",
#                          main = "Weekend",
#                          xlab = "",
#                          ylab = "",
#                          ylim = c(0,260))
activityByWeek
head(activity.inputed)
head(activity.inputed)
activityByWeek <- activity.inputed
for (i in 1:length(wDays)) {
if ( wDays[i] %in% c("sábado","Domingo")) {
wDays[i] <- "weekend"
} else {
wDays[i] <- "weekday"
}
}
activity.inputed$weekDays <- wDays
head(activity.inputed)
activityByWeek <- split(activity.inputed,activity.inputed$weekDays)
activityByWeek <- lapply(activityByWeek,function(x) tapply(x$steps,x$interval, mean))
#activityByWeek
#par(mfrow=c(1,2))
#par(mar=c(5,5,5,5))
#plot(intervals,activity.inputed$weekday,
#                          type = "l",
#                          col="black",
#                          main = "WeekDay",
#                          xlab = "Time intervals",
#                          ylab = "Average steps"),
#                          ylim = c(0,260))
#par(mar=c(5,5,5,5))
#plot(intervals,weekend,
#                          type = "l",
#                          col="black",
#                          main = "Weekend",
#                          xlab = "",
#                          ylab = "",
#                          ylim = c(0,260))
unique(weekdays(activity$date))
activityByWeek <- activity.inputed
for (i in 1:length(wDays)) {
if ( wDays[i] %in% c("sábado","domingo")) {
wDays[i] <- "weekend"
} else {
wDays[i] <- "weekday"
}
}
activity.inputed$weekDays <- wDays
head(activity.inputed)
activityByWeek <- split(activity.inputed,activity.inputed$weekDays)
activityByWeek <- lapply(activityByWeek,function(x) tapply(x$steps,x$interval, mean))
#activityByWeek
#par(mfrow=c(1,2))
#par(mar=c(5,5,5,5))
#plot(intervals,activity.inputed$weekday,
#                          type = "l",
#                          col="black",
#                          main = "WeekDay",
#                          xlab = "Time intervals",
#                          ylab = "Average steps"),
#                          ylim = c(0,260))
#par(mar=c(5,5,5,5))
#plot(intervals,weekend,
#                          type = "l",
#                          col="black",
#                          main = "Weekend",
#                          xlab = "",
#                          ylab = "",
#                          ylim = c(0,260))
head(activityByWeek)
activity <- read.csv(unz("activity.zip","activity.csv"),
header = TRUE,
colClasses = c("numeric","character","numeric"))
activity <- transform(activity, date = as.Date(date))
steps <- with(activity,tapply(steps,date,sum))
hist(steps,breaks = 50,col = "steelblue",
main = "Number of dairy steps distribution",
xlab = "Number of steps")
par( mar= c(5,5,5,5))
dates <- unique(activity$date)
means <- with(activity, tapply(steps,date, function(x) mean(x,na.rm = TRUE)))
medians <- with(activity, tapply(steps,date, function(x) median(x,na.rm = TRUE)))
plot(dates,means,pch=19,col="red",ylab = "Mean")
par(new=TRUE)
plot(dates,medians,pch=20,col="green",axes = FALSE,xlab = NA,ylab = NA)
axis(side=4)
mtext(side = 4,line = 3,"Median")
intervals <- unique(activity$interval)
mean.av <- with(activity,tapply(steps, interval,function(x) mean(x,na.rm = TRUE)))
plot(intervals,mean.av,type = "l",col="red",
main = "Average steps across day intervals",
ylab = "Average mean",
xlab = "Time intervals")
maxActivity <- intervals[which(mean.av==max(mean.av))]
maxActivity
with(activity, summary(steps))
activity.inputed <- activity
for (i in 1:length(activity$steps)) {
if ( is.na(activity$steps[i]) ) {
day <- activity$date[i]
activity.inputed$steps[i] <- mean(means,na.rm = TRUE)
}
}
with(activity.inputed, summary(steps))
wDays <- weekdays(activity.inputed$date)
activity.inputed$"weekDays" <- wDays
stepsByDay <- tapply(activity.inputed$steps,activity.inputed$date, function(x)                                                                    sum(x,na.rm = TRUE))
hist(stepsByDay,breaks = 30,col = "steelblue",
main = "Number of steps (Inputed data)",
xlab = "Number of steps")
means.in <- tapply(activity.inputed$steps,activity.inputed$date, function(x)                                                                    mean(x,na.rm = TRUE))
medians.in <- tapply(activity.inputed$steps,activity.inputed$date, function(x)                                                                    median(x,na.rm = TRUE))
## plotting means and medians of inputed data
par(mar=c(5,5,5,5))
plot(dates,means.in,
pch=19,col="red",ylab = "Mean")
par(new=TRUE)
plot(dates, medians.in,
pch=20, col="green",
axes = FALSE, ylim = c(-1,max(means.in)+1),
xlab = NA, ylab = NA)
axis(side=4)
mtext(side = 4,line = 3,"Median")
steps <- with(activity.inputed,tapply(steps,date,sum))
hist(steps,breaks = 50,col = "steelblue",
main = "Number of dairy steps distribution (inputed data)",
xlab = "Number of steps")
activityByWeek <- activity.inputed
for (i in 1:length(wDays)) {
if ( wDays[i] %in% c("sábado","domingo")) {
wDays[i] <- "weekend"
} else {
wDays[i] <- "weekday"
}
}
activity.inputed$weekDays <- wDays
head(activity.inputed)
activityByWeek <- split(activity.inputed,activity.inputed$weekDays)
activityByWeek <- lapply(activityByWeek,function(x) tapply(x$steps,x$interval, mean))
#activityByWeek
#par(mfrow=c(1,2))
#par(mar=c(5,5,5,5))
#plot(intervals,activity.inputed$weekday,
#                          type = "l",
#                          col="black",
#                          main = "WeekDay",
#                          xlab = "Time intervals",
#                          ylab = "Average steps"),
#                          ylim = c(0,260))
#par(mar=c(5,5,5,5))
#plot(intervals,weekend,
#                          type = "l",
#                          col="black",
#                          main = "Weekend",
#                          xlab = "",
#                          ylab = "",
#                          ylim = c(0,260))
head(activityByWeek)
names(activityByWeek)
activityByWeek <- activity.inputed
for (i in 1:length(wDays)) {
if ( wDays[i] %in% c("sábado","domingo")) {
wDays[i] <- "weekend"
} else {
wDays[i] <- "weekday"
}
}
activity.inputed$weekDays <- wDays
activityByWeek <- split(activity.inputed,activity.inputed$weekDays)
activityByWeek <- lapply(activityByWeek,function(x) tapply(x$steps,x$interval, mean))
par(mfrow=c(1,2))
par(mar=c(5,5,5,5))
plot(intervals,activity.inputed$weekday,
type = "l",
col="black",
main = "WeekDay",
xlab = "Time intervals",
ylab = "Average steps"),
activityByWeek <- activity.inputed
for (i in 1:length(wDays)) {
if ( wDays[i] %in% c("sábado","domingo")) {
wDays[i] <- "weekend"
} else {
wDays[i] <- "weekday"
}
}
activity.inputed$weekDays <- wDays
activityByWeek <- split(activity.inputed,activity.inputed$weekDays)
activityByWeek <- lapply(activityByWeek,function(x) tapply(x$steps,x$interval, mean))
par(mfrow=c(1,2))
par(mar=c(5,5,5,5))
plot(intervals,activity.inputed$weekday,
type = "l",
col="black",
main = "WeekDay",
xlab = "Time intervals",
ylab = "Average steps",
ylim = c(0,260))
par(mar=c(5,5,5,5))
plot(intervals,weekend,
type = "l",
col="black",
main = "Weekend",
xlab = "",
ylab = "",
ylim = c(0,260))
activityByWeek <- activity.inputed
wDays <- weekDays(activity.inputed$date)
activityByWeek <- activity.inputed
wDays <- weekdays(activity.inputed$date)
for (i in 1:length(wDays)) {
if ( wDays[i] %in% c("sábado","domingo")) {
wDays[i] <- "weekend"
} else {
wDays[i] <- "weekday"
}
}
activity.inputed$weekDays <- wDays
activityByWeek <- split(activity.inputed,activity.inputed$weekDays)
activityByWeek <- lapply(activityByWeek,function(x) tapply(x$steps,x$interval, mean))
par(mfrow=c(1,2))
par(mar=c(5,5,5,5))
plot(intervals,activity.inputed$weekday,
type = "l",
col="black",
main = "WeekDay",
xlab = "Time intervals",
ylab = "Average steps",
ylim = c(0,260))
par(mar=c(5,5,5,5))
plot(intervals,weekend,
type = "l",
col="black",
main = "Weekend",
xlab = "",
ylab = "",
ylim = c(0,260))
activityByWeek <- activity.inputed
wDays <- weekdays(activity.inputed$date)
for (i in 1:length(wDays)) {
if ( wDays[i] %in% c("sábado","domingo")) {
wDays[i] <- "weekend"
} else {
wDays[i] <- "weekday"
}
}
activity.inputed$weekDays <- wDays
activityByWeek <- split(activity.inputed,activity.inputed$weekDays)
activityByWeek <- lapply(activityByWeek,function(x) tapply(x$steps,x$interval, mean))
par(mfrow=c(1,2))
par(mar=c(5,5,5,5))
plot(intervals,activity.inputed$weekday,
type = "l",
col="black",
main = "WeekDay",
xlab = "Time intervals",
ylab = "Average steps",
ylim = c(0,260))
par(mar=c(5,5,5,5))
plot(intervals,activity.inputed$weekend,
type = "l",
col="black",
main = "Weekend",
xlab = "",
ylab = "",
ylim = c(0,260))
activityByWeek <- activity.inputed
wDays <- weekdays(activity.inputed$date)
for (i in 1:length(wDays)) {
if ( wDays[i] %in% c("sábado","domingo")) {
wDays[i] <- "weekend"
} else {
wDays[i] <- "weekday"
}
}
activity.inputed$weekDays <- wDays
activityByWeek <- split(activity.inputed,activity.inputed$weekDays)
activityByWeek <- lapply(activityByWeek,function(x) tapply(x$steps,x$interval, mean))
par(mfrow=c(1,2))
par(mar=c(5,5,5,5))
plot(intervals,activity.inputed$weekday,
type = "l",
col="black",
main = "WeekDay",
xlab = "Time intervals",
ylab = "Average steps")
par(mar=c(5,5,5,5))
plot(intervals,activity.inputed$weekend,
type = "l",
col="black",
main = "Weekend",
xlab = "",
ylab = "")
activityByWeek <- activity.inputed
wDays <- weekdays(activity.inputed$date)
for (i in 1:length(wDays)) {
if ( wDays[i] %in% c("sábado","domingo")) {
wDays[i] <- "weekend"
} else {
wDays[i] <- "weekday"
}
}
activity.inputed$weekDays <- wDays
activityByWeek <- split(activity.inputed,activity.inputed$weekDays)
activityByWeek <- lapply(activityByWeek,function(x) tapply(x$steps,x$interval, mean))
par(mfrow=c(1,2))
par(mar=c(5,5,5,5))
plot(intervals,activityByWeek$weekday,
type = "l",
col="black",
main = "WeekDay",
xlab = "Time intervals",
ylab = "Average steps")
par(mar=c(5,5,5,5))
plot(intervals,activityByWeek$weekend,
type = "l",
col="black",
main = "Weekend",
xlab = "",
ylab = "")
